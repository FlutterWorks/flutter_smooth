"use strict";(self.webpackChunksmooth=self.webpackChunksmooth||[]).push([[3270],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>d});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),c=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(r),d=n,m=u["".concat(l,".").concat(d)]||u[d]||h[d]||o;return r?a.createElement(m,i(i({ref:t},p),{},{components:r})):a.createElement(m,i({ref:t},p))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}u.displayName="MDXCreateElement"},8526:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=r(7462),n=(r(7294),r(3905));const o={},i="Target problems",s={unversionedId:"design/target",id:"design/target",title:"Target problems",description:'The main problem that the package solves, surely, is the jank caused by build and layout phase. As we know, build and layout phase is usually the slow and heavy part in the UI thread. This is also experimentally verified in the "benchmark" chapter.',source:"@site/docs/design/target.md",sourceDirName:"design",slug:"/design/target",permalink:"/flutter_smooth/design/target",draft:!1,editUrl:"https://github.com/fzyzcjy/flutter_smooth/tree/master/website/docs/design/target.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/flutter_smooth/design/intro"},next:{title:"Scenarios",permalink:"/flutter_smooth/design/scenario"}},l={},c=[{value:"Jank by garbage collection",id:"jank-by-garbage-collection",level:2},{value:"Jank by memory locality",id:"jank-by-memory-locality",level:2},{value:"Jank by other phases",id:"jank-by-other-phases",level:2}],p={toc:c};function h(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"target-problems"},"Target problems"),(0,n.kt)("p",null,'The main problem that the package solves, surely, is the jank caused by build and layout phase. As we know, build and layout phase is usually the slow and heavy part in the UI thread. This is also experimentally verified in the "benchmark" chapter.'),(0,n.kt)("p",null,"In addition, there are some other problems that this package seem to solve as well, and I list it as follows. I have not done solid experiments, so these are mainly theoretical analysis - feel free to PR your experiments if you are interested."),(0,n.kt)("h2",{id:"jank-by-garbage-collection"},"Jank by garbage collection"),(0,n.kt)("p",null,"This is mainly described in ",(0,n.kt)("a",{parentName:"p",href:"infra/gc/between-frame"},"the GC section"),". To summarize, without this package, GC will cause a jank if it runs more than (16.67-N) milliseconds where N is the UI thread duration, which is very possible. On the other hand, with this package, even if GC needs to run for (for example) 14ms per 16.67ms, there will be no jank."),(0,n.kt)("h2",{id:"jank-by-memory-locality"},"Jank by memory locality"),(0,n.kt)("p",null,"As ",(0,n.kt)("a",{parentName:"p",href:"https://discord.com/channels/608014603317936148/608021234516754444/1022296432738320454"},"pointed out")," by @gaaclarke, a possible source of slowness is memory locality problem, due to the nature of Dart and Flutter, which will be hard to fix. However, this package seems to fix it, because it solves whatever causes the build/layout slowness."),(0,n.kt)("h2",{id:"jank-by-other-phases"},"Jank by other phases"),(0,n.kt)("p",null,"Firstly, if the ",(0,n.kt)("inlineCode",{parentName:"p"},"finalize")," phase executes too long, it seems quite easy to modify the current code a little bit to add preempt rendering into that phase, such that it never janks. This is because already have a preempt at the end of it and that phase does not touch the layer tree."),(0,n.kt)("p",null,"Secondly, for jank by phases like ",(0,n.kt)("inlineCode",{parentName:"p"},"animation"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"compositing")," and so on, it seems possible to inject preempt rendering as well. I have not checked into the details, because those phases are really fast and I never see a real-world case yet. But if you do, do not hesitate to create an issue."))}h.isMDXComponent=!0}}]);